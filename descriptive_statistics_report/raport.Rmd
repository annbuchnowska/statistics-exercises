---
title: "Descriptive Statistics Report"
author: "Anna Buchnowska"
date: "7 grudnia 2016"
output:
  pdf_document: 
    fig_caption: yes
    fig_height: 4.5
    keep_tex: yes
    toc: yes
---

```{r setup, include=FALSE}
library(psych)
library(knitr)
knitr::opts_chunk$set(echo = FALSE)
```


# Introduction

Following output is generated by RStudio. The data set for this case study was intended to answer the question: 

> What is the inter-relation between these three
> variables? How much total information do they provide?

## Descriptive (summary) analysis  
The  purpose  of  the  descriptive  statistics  is  to  provide  the  reader  with  an  idea  about  the  basic  elements  of  the  groups  being  studied.  

```{r comment=NA, echo=FALSE, warning=FALSE}
data <- read.csv('../oceny.csv', header = TRUE, sep=';')
colnames(data) <- c("group", "grades", 'IQ',  'earnings')
data$grades <- as.numeric(gsub(",", ".", data$grades))
data$grades <- as.numeric(data$grades)
mydata <- as.table(summary(data))
mydata

```

## Modality distributions

Shapiro-Wilk test of normality. The significance level of the test - 0.05 ($\alpha$)

1. grades

$H_0$: The sample comes from a normal distribution.   
$H_1$: The sample doesn't come from a normal distribution.

```{r comment=NA, echo=FALSE, warning=FALSE}
shapiro.test(data$grades)
```
P-value is greater than $\alpha$ = 0.05. Observed data is consistent with the null hypothesis.
  
2. IQ

$H_0$: The sample comes from a normal distribution.   
$H_1$: The sample doesn't come from a normal distribution.

```{r comment=NA, echo=FALSE, warning=FALSE}
shapiro.test(data$IQ)
```
P-value is greater than $\alpha$ = 0.05. Observed data is consistent with the null hypothesis.    

2. earnings

$H_0$: The sample comes from a normal distribution.   
$H_1$: The sample doesn't come from a normal distribution.

```{r comment=NA, echo=FALSE, warning=FALSE}
shapiro.test(data$earnings)
```
P-value is effectively close to zero. observed data is inconsistent with the null hypothesis.  
Reject the null hypothesis $H_0$ in favor of the alternative hypothesis




## Histogram
```{r}
hist(data$grades,
     main="Histogram for grades",
     xlab="grades",
     xlim = c(2,5),
     breaks = 5,
     col="darkgray", 
     border="black")
rug(data$grades)

hist(data$earnings,
     main="Histogram for earnings with outliers",
     xlab="earnings",
     col="darkgray", 
     border="black")

remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}
data_new <- remove_outliers(data$earnings)
hist(data_new,
     main="Histogram for earnings without outliers",
     xlab="earnings",
     col="darkgray", 
     border="black")


hist(data$IQ,
     main="Histogram for IQ",
     xlab="IQ",
     col="darkgray", 
     border="black")

```
```{r}
describeBy(data, group = data$group)
```

##Boxplot